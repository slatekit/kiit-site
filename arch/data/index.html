<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    

    <base href="../../">
          
      
    <link href="https://fonts.googleapis.com/css?family=Dosis:300,400,500,600,700,800&display=swap" rel="stylesheet">
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/mobirise.css">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/fontawesome-all.min.css">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/bootstrap.min.css">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/slick.css">
    <link rel="stylesheet" href="assets/theme/css/plugins/slick-theme.css">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/theme/css/plugins/owl.theme.default.min.css">
    
    <link rel="stylesheet" href="assets/theme/css/plugins/animate.css">
    
    <link rel="stylesheet" href="assets/theme/css/agency-2.css">

    <link rel="icon" href="assets/app/media/slatekit_logo_v3.png">


    <link rel="stylesheet" href="assets/theme/css/about-1.css">
    <link rel="stylesheet" href="assets/app/slatekit.css">
    <link rel="stylesheet" href="assets/app/syntax.css">
          
   
    
   


    <title>Slate Kit: Data</title>
</head>

<body>

    
    <div class="se-pre-con"></div>

    
        
        <div class="header-classic fixed-top navbar-light wow fadeInDown">
            
            <div class="container">
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <nav class="navbar navbar-expand-lg navbar-classic">
                            <a class="navbar-brand" href="#0">
    <img src="assets/app/media/slatekit_logo_v3.png" width="40%" alt="" />
</a>
                            <button
                                class="navbar-toggler collapsed"
                                type="button"
                                data-toggle="collapse"
                                data-target="#navbar-classic"
                                aria-controls="navbar-classic"
                                aria-expanded="false"
                                aria-label="Toggle navigation">
                                <span class="icon-bar top-bar mt-0"></span>
                                <span class="icon-bar middle-bar"></span>
                                <span class="icon-bar bottom-bar"></span>
                            </button>
                            <div class="collapse navbar-collapse" id="navbar-classic">
                                <ul class="navbar-nav ml-auto mt-2 mt-lg-0 mr-3">
                                    
    <li class="nav-item">
        <a class="nav-link" href="/">Home</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="/start/overview">Overview</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="/info/updates">Updates</a>
    </li>
    <li class="nav-item dropdown">
        <a
            class="nav-link dropdown-toggle"
            href="#"
            id="menu-1"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false">
            Start
        </a>
        <ul class="dropdown-menu" aria-labelledby="menu-1">
            <li><a class="dropdown-item" href="start/setup">Setup</a></li>
            <li><a class="dropdown-item" href="start/hello_world">Hello World</a></li>
            <li><a class="dropdown-item" href="start/generators">Generators</a></li>
        </ul>
    </li>
    <li class="nav-item dropdown">
        <a
            class="nav-link dropdown-toggle"
            href="#"
            id="menu-1"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false">
            Components
        </a>
        <ul class="dropdown-menu" aria-labelledby="menu-1">
            <li><a class="dropdown-item" href="arch/overview">Overview</a></li>
            <li><a class="dropdown-item" href="arch/results">Results</a></li>
            <li><a class="dropdown-item" href="arch/app">App</a></li>
            <li><a class="dropdown-item" href="arch/apis">API</a></li>
            <li><a class="dropdown-item" href="arch/jobs">Jobs</a></li>
            <li><a class="dropdown-item" href="arch/overview">More...</a></li>
        </ul>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="utils/overview">Utilities</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="/info/license">License</a>
    </li>
    
    <li class="nav-item dropdown">
        <a
            class="nav-link dropdown-toggle"
            href="#"
            id="menu-1"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false">
            More
        </a>
        <ul class="dropdown-menu" aria-labelledby="menu-1">
            <li><a class="dropdown-item" href="https://github.com/slatekit/slatekit/releases">Releases</a></li>
            <li><a class="dropdown-item" href="info/about">About</a></li>
            <li><a class="dropdown-item" href="info/contact">Contact</a></li>
            <li><a class="dropdown-item" href="info/faq">FAQ</a></li>
            <li><a class="dropdown-item" href="info/standards">Standards</a></li>
            
        </ul>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="https://github.com/slatekit/slatekit">Github</a>
    </li>
</ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
            
        </div>
        
        
    
    
    
    
      <div class="container-fluid">
        <div class="row">
            <div class="col-sm-2 d-none d-lg-block">
                <div id="sidebar-wrapper">
   <div class="sidebar-header">
      <a class="brand" href="/">
      <span>Index</span>
      </a>
      
      </button>
   </div>
   <div id="sk_arch_component_menu_sections" class="sidebar-nav">
        
    </div>
</div>
            </div>
            <div class="col-lg-9 flex">
                <section class="features">
                    <div class="container-fluid text-center">
                        <div class="mx-auto">
                            <a id="sk_arch_component_link" href="arch/cli">
                                <img id="sk_arch_component_img" src="assets/media/img/white/desktop.png" alt="" style="width:70px;" class="img-fluid">
                            </a>
                            <h1 id="sk_arch_component_name">App</h1>
                        </div>
                    </div>
                </section>
                

<h1 id="overview">Overview</h1>

<p>Slate Kit contains 3 modules for working with <strong>data and databases</strong>. These allow you to leverage existing code for low-level database calls, mid-level interfaces/abstractions for Entities/Repositories/Services or high-level ORM functionality.
<br/><br/></p>

<h1 id="goals">Goals</h1>

<table class="table table-bordered table-striped">
    <tr>
        <td><strong>Goal</strong></td>
        <td><strong>Description</strong></td>
    </tr>
    <tr>
        <td><strong>1. Low-Level</strong></td>
        <td>Provide a low-level database API for JDBC and/or Android Sqlite</td>
    </tr>
    <tr>
        <td><strong>2. Entities </strong> </td>
        <td>Provide interfaces/defaults for Entities / Repositories / Services.</td>                     
    </tr>
    <tr>
        <td><strong>3. ORM</strong></td>
        <td>Provide a light-weight ORM for both Android ( Sqlite ) and Server. </td>
    </tr>
</table>

<br/><br/>

<h1 id="status">Status</h1>

<p>This component is currently stable and works with <strong>MySql</strong>.
Future versions will include support for:
<table class="table table-bordered table-striped">
    <tr>
        <td><strong>Feature</strong></td>
        <td><strong>Status</strong></td>
        <td><strong>Description</strong></td>
    </tr>
    <tr>
        <td><strong>PostGres</strong></td>
        <td>In Progress</td>
        <td>Support for PostGres database</td>
    </tr>
    <tr>
        <td><strong>Android</strong></td>
        <td>In Progress</td>
        <td>Implementations currently internal only but not yet open-sourced.</td>
    </tr>
    <tr>
        <td><strong>Transactions</strong></td>
        <td>In Progress</td>
        <td>For server side</td>
    </tr>
    <tr>
        <td><strong>Exposed</strong></td>
        <td>Future</td>
        <td>Integration with the <strong>JetBrains Exposed ORM</strong> instead of Slate Kit ORM</td>
    </tr>
</table></p>

<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/>

<h1 id="install">Install</h1>

<p><div class="highlight"><pre class="chroma"><code class="language-groovy" data-lang="groovy">    <span class="n">repositories</span> <span class="o">{</span>
        <span class="c1">// other repositories
</span><span class="c1"></span>        <span class="n">maven</span> <span class="o">{</span> <span class="n">url</span>  <span class="s2">&#34;http://dl.bintray.com/codehelixinc/slatekit&#34;</span> <span class="o">}</span>
    <span class="o">}</span>

    <span class="n">dependencies</span> <span class="o">{</span>
        <span class="c1">// other dependencies ...
</span><span class="c1"></span>
        <span class="c1">// Common code for all components
</span><span class="c1"></span>        <span class="n">compile</span> <span class="s1">&#39;com.slatekit:slatekit-common:1.0.0&#39;</span>

        <span class="c1">// For database calls to work with JDBC
</span><span class="c1"></span>        <span class="n">compile</span> <span class="s1">&#39;com.slatekit:slatekit-db:1.0.0&#39;</span>

        <span class="c1">// Entities / Repositories / Service interfaces and defaults
</span><span class="c1"></span>        <span class="n">compile</span> <span class="s1">&#39;com.slatekit:slatekit-entities:1.0.0&#39;</span>

        <span class="c1">// ORM functionality to map to/from models and records and query
</span><span class="c1"></span>        <span class="n">compile</span> <span class="s1">&#39;com.slatekit:slatekit-orm:1.0.0&#39;</span>
    <span class="o">}</span></code></pre></div>
<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/></p>

<h1 id="sources">Sources</h1>


<table class="table table-bordered table-striped">
  <tr>
    <td><strong>Jar</strong></td>
    <td>slatekit.entities.jar</td>
  </tr>
  <tr>
    <td><strong>Package</strong></td>
    <td>slatekit.entities</td>
  </tr>
  <tr>
    <td><strong>Sources</strong></td>
    <td><a class="url-ch" href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-entities">slatekit-entities</a></td>
  </tr>
  <tr>
      <td><strong>Example</strong></td>
      <td><a class="url-ch" href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-examples/src/main/kotlin/slatekit/examples/">Example_Entities.kt</a></td>
  </tr>
  <tr>
    <td><strong>Version</strong></td>
    <td><img src="https://api.bintray.com/packages/codehelixinc/slatekit/slatekit-entities/images/download.svg" /></td>
  </tr>
  <tr>
    <td><strong>License</strong></td>
    <td><img src="https://img.shields.io/badge/license-Apache2-green.svg?style=flat" /></td>
  </tr>
  <tr>
    <td><strong>Requires</strong></td>
    <td>See <a class="url-ch" href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-entities/build.gradle">build.gradle</a> for more info. </td>
  </tr>
</table>

<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/>

<h1 id="example">Example</h1>

<p><div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="k">fun</span> <span class="nf">quick_sample</span><span class="p">()</span> <span class="p">{</span>
        
    <span class="p">}</span></code></pre></div>
<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/></p>

<h1 id="guide">Guide</h1>

<p><table class="table table-bordered table-striped">
    <tr>
        <td><strong>Name</strong></td>
        <td><strong>Description</strong></td>
        <td><strong>More</strong></td>
    </tr>
    <tr>
        <td><strong>1. Connections</strong></td>
        <td>Setting up database connections</td>
        <td><a href="arch/data/#connections" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>2. Databases</strong> </td>
        <td>Low-level database calls and operations</td>
        <td><a href="arch/data/#databases" class="more"><span class="btn btn-primary">more</span></a></td><br />
    </tr>
    <tr>
        <td><strong>3. Records</strong></td>
        <td>Working with records from the database</td>
        <td><a href="arch/data/#records" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>4. Mappers</strong></td>
        <td>Setting up mappers for converting to/from models to records</td>
        <td><a href="arch/data/#mappers" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>5. Repositories</strong></td>
        <td>Using Repositories for common CRUD operations on data</td>
        <td><a href="arch/data/#repos" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>6. Services</strong></td>
        <td>Entity Services for managing data models</td>
        <td><a href="arch/data/#services" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>7. Vendors</strong></td>
        <td>Support for different databases and setup</td>
        <td><a href="arch/data/#vendors" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>8. Schemas</strong></td>
        <td>Defining your data models as schema for auto-mapping</td>
        <td><a href="arch/data/#schemas" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>9. ORM</strong></td>
        <td>Light-weight ORM layer to managing/querying databases</td>
        <td><a href="arch/data/#orm" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>10. Events</strong></td>
        <td>Observing data operations as events</td>
        <td><a href="arch/data/#events" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
    <tr>
        <td><strong>11. Migrations</strong></td>
        <td>Dealing with upgrades to schemas</td>
        <td><a href="arch/data/#migrations" class="more"><span class="btn btn-primary">more</span></a></td>
    </tr>
</table>
<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/></p>

<h2 id="connections">Connections</h2>

<p>You can setup connections different ways from explicit creation to loading from configuration settings. This uses <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/data/DbCon.kt" >DbCon</a>. The <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/data/Connections.kt" >Connections</a> is used to store multiple connections by name.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// Connection
</span><span class="c1"></span>    <span class="c1">// 1. Explicit creation
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">con1</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">MySql</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:mysql://localhost/default&#34;</span><span class="p">,</span> <span class="s">&#34;user1&#34;</span><span class="p">,</span> <span class="s">&#34;pswd3210&#34;</span><span class="p">)</span>

    <span class="c1">// 2. From config
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">cfg</span> <span class="p">=</span> <span class="n">Config</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="s">&#34;env.dev.conf&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">con2</span> <span class="p">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">dbCon</span><span class="p">(</span><span class="s">&#34;db&#34;</span><span class="p">)</span>

    <span class="c1">// Connections ( collection of multiple connections )
</span><span class="c1"></span>    <span class="c1">// 1. From single connection
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">cons1</span> <span class="p">=</span> <span class="n">Connections</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>

    <span class="c1">// 2. From config: Shortcut for Connections.of(conf.dbCon(&#34;db&#34;))
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">cons2</span> <span class="p">=</span> <span class="n">Connections</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

    <span class="c1">// 3. From multiple named connections
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">cons3</span> <span class="p">=</span> <span class="n">Connections</span><span class="p">.</span><span class="n">named</span><span class="p">(</span>
            <span class="n">listOf</span><span class="p">(</span>
                    <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;db1&#34;</span><span class="p">,</span> <span class="n">con1</span><span class="p">),</span>
                    <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;db2&#34;</span><span class="p">,</span> <span class="n">con2</span><span class="p">)</span>
            <span class="p">))</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="databases">Databases</h2>

<p>The <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/data/IDb.kt" >IDb</a> interface provides a thin abstraction over data access calls, particularly JDBC. This makes it useful for abstracting data access to both Server side database calls via JDBC and Android database calls to Sqlite. Another benefit is facilitating unit-testing/mocking of other data related components in Slate Kit. The interface and supporting implementation for JDBC <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-db/src/main/kotlin/slatekit/db/Db.kt" >Db</a> support the typical operations to perform <strong>execute, update, query, scalar, stored proc</strong> calls.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">     
    <span class="k">val</span> <span class="py">con1</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">MySql</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:mysql://localhost/default&#34;</span><span class="p">,</span> <span class="s">&#34;user1&#34;</span><span class="p">,</span> <span class="s">&#34;pswd3210&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">db</span> <span class="p">=</span> <span class="n">Db</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>

    <span class="c1">// Inserts
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">id1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&#34;insert into `city`(`name`) values( &#39;ny&#39; )&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">id2</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&#34;insert into `city`(`name`) values( ? )&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&#34;ny&#34;</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">id3</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">insertGetId</span><span class="p">(</span><span class="s">&#34;insert into `city`(`name`) values( ? )&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&#34;ny&#34;</span><span class="p">)).</span><span class="n">toLong</span><span class="p">()</span>

    <span class="c1">// Updates
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">updated1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="s">&#34;update `city` set `alias` = &#39;nyc&#39; where id = 2&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">updated2</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="s">&#34;update `city` set `alias` = &#39;nyc&#39; where id = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="n">id2</span><span class="p">))</span>

    <span class="c1">// Deletes
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">deleted1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="s">&#34;delete from `city` where id = 2&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">deleted2</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="s">&#34;delete from `city` where id = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">2</span><span class="p">))</span>

    <span class="c1">// Procs
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">procUpdate1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">callUpdate</span><span class="p">(</span><span class="s">&#34;dbtests_activate_by_id&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">2</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">procQuery1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">callQuery</span><span class="p">(</span><span class="s">&#34;dbtests_max_by_id&#34;</span><span class="p">,</span>
            <span class="n">callback</span> <span class="p">=</span> <span class="p">{</span> <span class="n">rs</span> <span class="p">-&gt;</span> <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">},</span> <span class="n">inputs</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="n">id2</span><span class="p">))</span>

    <span class="c1">// Queries ( mapOne, mapMany )
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">city1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">mapOne</span><span class="p">&lt;</span><span class="n">City</span><span class="p">&gt;(</span><span class="s">&#34;select * from `city` where id = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="p">{</span> <span class="n">rs</span> <span class="p">-&gt;</span>
        <span class="n">City</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="n">getLong</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">),</span> <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">),</span> <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;alias&#34;</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">val</span> <span class="py">city2</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">mapAll</span><span class="p">&lt;</span><span class="n">City</span><span class="p">&gt;(</span><span class="s">&#34;select * from `city` where id &lt; ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">2</span><span class="p">))</span> <span class="p">{</span> <span class="n">rs</span> <span class="p">-&gt;</span>
        <span class="n">City</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="n">getLong</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">),</span> <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">),</span> <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;alias&#34;</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="c1">// Scalar calls
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">total1</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarBool</span><span class="p">(</span><span class="s">&#34;select isActive from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total2</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarInt</span><span class="p">(</span><span class="s">&#34;select age from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total3</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarLong</span><span class="p">(</span><span class="s">&#34;select account from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total4</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarFloat</span><span class="p">(</span><span class="s">&#34;select salary from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total5</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarDouble</span><span class="p">(</span><span class="s">&#34;select total from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total6</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarString</span><span class="p">(</span><span class="s">&#34;select email from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total7</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarLocalDate</span><span class="p">(</span><span class="s">&#34;select startDate from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total8</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarLocalTime</span><span class="p">(</span><span class="s">&#34;select startHour from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total9</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarLocalDateTime</span><span class="p">(</span><span class="s">&#34;select registered from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">total10</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">getScalarZonedDateTime</span><span class="p">(</span><span class="s">&#34;select activated from users where userid = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="records">Records</h2>

<p>Because the Database abstracts over JDBC, there is also a corresponding interface <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/Record.kt" >Record</a> to abstract over JDBC ResultSets ( this is particularly useful for Android ). The implementation for JDBC is <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-db/src/main/kotlin/slatekit/db/RecordSet.kt" >RecordSet</a>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">     
    <span class="c1">// Sample connection/DB
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">con1</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">MySql</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:mysql://localhost/default&#34;</span><span class="p">,</span> <span class="s">&#34;user1&#34;</span><span class="p">,</span> <span class="s">&#34;pswd3210&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">db</span> <span class="p">=</span> <span class="n">Db</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>

    <span class="c1">// Record via wrapped JDBC ResultSet
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">city</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">mapOne</span><span class="p">&lt;</span><span class="n">City</span><span class="p">&gt;(</span><span class="s">&#34;select * from `city` where id = ?&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="p">{</span> <span class="n">rs</span><span class="p">:</span><span class="n">Record</span> <span class="p">-&gt;</span>
        <span class="n">City</span><span class="p">(</span>   <span class="n">rs</span><span class="p">.</span><span class="n">getLong</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">),</span>
                <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">),</span>
                <span class="n">rs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;alias&#34;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Simulating a Record from a list of key/value pairs
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">record</span><span class="p">:</span><span class="n">Record</span> <span class="p">=</span> <span class="n">RecordMap</span><span class="p">(</span>
            <span class="n">ListMap</span><span class="p">(</span>
                    <span class="n">listOf</span><span class="p">(</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="m">1L</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;uuid&#34;</span><span class="p">,</span> <span class="s">&#34;ABC&#34;</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">,</span> <span class="s">&#34;kishore@abc.com&#34;</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;isActive&#34;</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span> <span class="m">35</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="n">Status</span><span class="p">.</span><span class="n">InActive</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;salary&#34;</span><span class="p">,</span> <span class="m">400.5</span><span class="p">),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;uid&#34;</span><span class="p">,</span> <span class="n">UUID</span><span class="p">.</span><span class="n">fromString</span><span class="p">(</span><span class="s">&#34;ad6ec896-bc1e-4430-b13c-88e3d4924a6a&#34;</span><span class="p">)),</span>
                            <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;createdAt&#34;</span><span class="p">,</span> <span class="n">DateTimes</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="m">2017</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
                            <span class="p">)</span>
            <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1">// There are getX methods, getXOrNull, getXOrDefault
</span><span class="c1"></span>    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getBool</span><span class="p">(</span><span class="s">&#34;isActive&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getBoolOrNull</span><span class="p">(</span><span class="s">&#34;isActive&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getBoolOrElse</span><span class="p">(</span><span class="s">&#34;isActive&#34;</span><span class="p">,</span> <span class="k">false</span><span class="p">))</span>
    
    <span class="c1">// There are several methods for various types
</span><span class="c1"></span>    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getBool</span><span class="p">(</span><span class="s">&#34;isActive&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getInt</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getLong</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getDouble</span><span class="p">(</span><span class="s">&#34;salary&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getUUID</span><span class="p">(</span><span class="s">&#34;uuid&#34;</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">getZonedDateTime</span><span class="p">(</span><span class="s">&#34;createdAt&#34;</span><span class="p">))</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="mappers">Mappers</h2>

<p>A <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/db/Mapper.kt" >Mapper</a> simply encodes/decodes a data model to/from records. The <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-common/src/main/kotlin/slatekit/common/db/Value.kt" >Values</a> is simply a container for key/value pairs representing all the fields on the field that can be persisted/saved to a database. You can simply implement the mapping yourself ( explicitly without any reflection ) or use the OrmMapper ( see ORM section ) along with a schema for the Model to leverage automatic mapping.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// Mapper: manual field mapping
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">mapper</span> <span class="p">=</span> <span class="k">object</span><span class="p">:</span> <span class="n">Mapper</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">User</span><span class="p">&gt;</span> <span class="p">{</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">encode</span><span class="p">(</span><span class="n">model</span><span class="p">:</span><span class="n">User</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">DataAction</span><span class="p">):</span> <span class="n">Values</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">listOf</span><span class="p">(</span>
                    <span class="n">Value</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">id</span><span class="p">),</span>
                    <span class="n">Value</span><span class="p">(</span><span class="s">&#34;firstname&#34;</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">firstName</span><span class="p">),</span>
                    <span class="n">Value</span><span class="p">(</span><span class="s">&#34;lastname&#34;</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">lastName</span><span class="p">),</span>
                    <span class="n">Value</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">email</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">decode</span><span class="p">(</span><span class="n">record</span><span class="p">:</span> <span class="n">Record</span><span class="p">):</span> <span class="n">User</span><span class="p">?</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">User</span><span class="p">(</span>
                    <span class="n">id</span> <span class="p">=</span> <span class="n">record</span><span class="p">.</span><span class="n">getLong</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">),</span>
                    <span class="n">firstName</span> <span class="p">=</span> <span class="n">record</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;firstname&#34;</span><span class="p">),</span>
                    <span class="n">lastName</span> <span class="p">=</span> <span class="n">record</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;lastname&#34;</span><span class="p">),</span>
                    <span class="n">email</span> <span class="p">=</span> <span class="n">record</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="repos">Repository</h2>

<p>With the databases, records, mappers in place, the next step is to have a <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-entities/src/main/kotlin/slatekit/entities/Repo.kt" >Repo</a> component that can handle the common <strong>CRUD</strong> operations on model. The implementations for these are <a href="https://github.com/slatekit/slatekit/tree/master/src/lib/kotlin/slatekit-entities/src/main/kotlin/slatekit/entities/repos/SqlRepo.kt" >SqlRepo</a>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    
    <span class="c1">// Setup: This is boiler-plate that can be moved
</span><span class="c1"></span>    <span class="c1">// to a helper function/builder
</span><span class="c1"></span>    <span class="c1">// 1. connection
</span><span class="c1"></span>    <span class="c1">// 2. database
</span><span class="c1"></span>    <span class="c1">// 3. mapper
</span><span class="c1"></span>    <span class="c1">// 4. repo
</span><span class="c1"></span>    <span class="c1">// 5. service
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">con</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">H2</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">db</span> <span class="p">=</span> <span class="n">Db</span><span class="p">.</span><span class="k">open</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">mapper</span><span class="p">:</span><span class="n">Mapper</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mapper</span><span class="p">()</span>
    <span class="k">val</span> <span class="py">repo</span> <span class="p">=</span> <span class="n">Repo</span><span class="p">.</span><span class="n">h2</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">db</span><span class="p">,</span> <span class="n">mapper</span><span class="p">)</span>

    <span class="c1">// Common CRUD ( Create, Retrieve, Update, Delete ) operations available
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">city</span> <span class="p">=</span> <span class="n">City</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">,</span> <span class="s">&#34;bk&#34;</span><span class="p">)</span>

    <span class="c1">// Create
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">id</span> <span class="p">=</span> <span class="n">repo</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">City</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&#34;New York&#34;</span><span class="p">,</span> <span class="s">&#34;NYC&#34;</span><span class="p">))</span>

    <span class="c1">// Checks
</span><span class="c1"></span>    <span class="n">repo</span><span class="p">.</span><span class="n">any</span><span class="p">()</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">count</span><span class="p">()</span>

    <span class="c1">// Gets
</span><span class="c1"></span>    <span class="n">repo</span><span class="p">.</span><span class="n">getAll</span><span class="p">()</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">getById</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">getByIds</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">first</span><span class="p">()</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">last</span><span class="p">()</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">recent</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">oldest</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>

    <span class="c1">// Finds
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">item1</span> <span class="p">=</span> <span class="n">repo</span><span class="p">.</span><span class="n">findOneByField</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;=&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">items2</span> <span class="p">=</span> <span class="n">repo</span><span class="p">.</span><span class="n">findByField</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;=&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">items3</span> <span class="p">=</span> <span class="n">repo</span><span class="p">.</span><span class="n">findByFields</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">)))</span>
    <span class="k">val</span> <span class="py">items4</span><span class="p">=</span> <span class="n">repo</span><span class="p">.</span><span class="n">findIn</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&#34;Queens&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">))</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">repo</span><span class="p">.</span><span class="n">query</span><span class="p">())</span>

    <span class="c1">// Updates
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">updated</span> <span class="p">=</span> <span class="n">city</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">&#34;Queens&#34;</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;Queens City&#34;</span><span class="p">),</span> <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;alias&#34;</span><span class="p">,</span> <span class="s">&#34;QCity&#34;</span><span class="p">)))</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">updateByField</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;Queens&#34;</span><span class="p">,</span> <span class="s">&#34;Queens City&#34;</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">updateField</span><span class="p">(</span><span class="s">&#34;tag&#34;</span><span class="p">,</span> <span class="s">&#34;test&#34;</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">updateByProc</span><span class="p">(</span><span class="s">&#34;update_alias&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">&#34;QCity&#34;</span><span class="p">))</span>

    <span class="c1">// Deletes
</span><span class="c1"></span>    <span class="n">repo</span><span class="p">.</span><span class="n">deleteAll</span><span class="p">()</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">deleteById</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">deleteByIds</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">deleteByField</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
    <span class="n">repo</span><span class="p">.</span><span class="n">deleteByQuery</span><span class="p">(</span><span class="n">repo</span><span class="p">.</span><span class="n">query</span><span class="p">().</span><span class="k">where</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="services">Services</h2>

<p>Entity Services expose CRUD operations on your data model in a &ldquo;managed way&rdquo; via Service layer. This is to avoid other code/services from directly modifying your models via the Repo/Repositories and for allow you to override various methods to add in your custom logic for CRUD operations. You can also pick and choose which features (Read only, Write only, full CRUD ) you want applicable for your service. This allows using Slate Kit for standardizing <strong>Repositories / Services</strong>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// Setup: This is boiler-plate that can be moved
</span><span class="c1"></span>    <span class="c1">// to a helper function/builder
</span><span class="c1"></span>    <span class="c1">// 1. connection
</span><span class="c1"></span>    <span class="c1">// 2. database
</span><span class="c1"></span>    <span class="c1">// 3. mapper
</span><span class="c1"></span>    <span class="c1">// 4. repo
</span><span class="c1"></span>    <span class="c1">// 5. service
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">con</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">H2</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">db</span> <span class="p">=</span> <span class="n">Db</span><span class="p">.</span><span class="k">open</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">mapper</span><span class="p">:</span><span class="n">Mapper</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mapper</span><span class="p">()</span>
    <span class="k">val</span> <span class="py">repo</span> <span class="p">=</span> <span class="n">Repo</span><span class="p">.</span><span class="n">h2</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">db</span><span class="p">,</span> <span class="n">mapper</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">service</span> <span class="p">=</span> <span class="n">EntityService</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">repo</span><span class="p">)</span>

    <span class="c1">// CRUD operations
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">city</span> <span class="p">=</span> <span class="n">City</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">,</span> <span class="s">&#34;bk&#34;</span><span class="p">)</span>

    <span class="c1">// Create
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">id</span> <span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">City</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&#34;New York&#34;</span><span class="p">,</span> <span class="s">&#34;NYC&#34;</span><span class="p">))</span>

    <span class="c1">// Checks
</span><span class="c1"></span>    <span class="n">service</span><span class="p">.</span><span class="n">any</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">count</span><span class="p">()</span>

    <span class="c1">// Gets
</span><span class="c1"></span>    <span class="n">service</span><span class="p">.</span><span class="n">getAll</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">getById</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">getByIds</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
    <span class="n">service</span><span class="p">.</span><span class="n">first</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">last</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">recent</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">oldest</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>

    <span class="c1">// Finds
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">item1</span> <span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">findOneByField</span><span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">email</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span><span class="s">&#34;Brooklyn&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">items2</span> <span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">findByField</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">name</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">items3</span> <span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">findByFields</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">)))</span>
    <span class="k">val</span> <span class="py">items4</span><span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">findIn</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">name</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="s">&#34;Queens&#34;</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">))</span>
    <span class="k">val</span> <span class="py">items5</span> <span class="p">=</span> <span class="n">service</span><span class="p">.</span><span class="n">findByQuery</span><span class="p">(</span><span class="n">Query</span><span class="p">().</span><span class="k">where</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">name</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="s">&#34;Brooklyn&#34;</span><span class="p">))</span>

    <span class="c1">// Updates
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">updated</span> <span class="p">=</span> <span class="n">city</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">&#34;Queens&#34;</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">patch</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="n">Pair</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">,</span> <span class="s">&#34;Queens City&#34;</span><span class="p">),</span> <span class="n">Pair</span><span class="p">(</span><span class="s">&#34;alias&#34;</span><span class="p">,</span> <span class="s">&#34;QCity&#34;</span><span class="p">)))</span>
    <span class="n">service</span><span class="p">.</span><span class="n">updateByField</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">name</span><span class="p">,</span> <span class="s">&#34;Queens&#34;</span><span class="p">,</span> <span class="s">&#34;Queens City&#34;</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">updateField</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">name</span><span class="p">,</span> <span class="s">&#34;test&#34;</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">updateByProc</span><span class="p">(</span><span class="s">&#34;update_alias&#34;</span><span class="p">,</span> <span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">&#34;QCity&#34;</span><span class="p">))</span>

    <span class="c1">// Deletes
</span><span class="c1"></span>    <span class="n">service</span><span class="p">.</span><span class="n">deleteAll</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">deleteById</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">deleteByIds</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
    <span class="n">service</span><span class="p">.</span><span class="n">deleteByField</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">id</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
    <span class="n">service</span><span class="p">.</span><span class="n">deleteByQuery</span><span class="p">(</span><span class="n">Query</span><span class="p">().</span><span class="k">where</span><span class="p">(</span><span class="n">City</span><span class="o">::</span><span class="n">id</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Op</span><span class="p">.</span><span class="n">Eq</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="schemas">Schemas</h2>

<p>You can set up auto-mapping of models to/from records using the Slate Kit Model Schemas. This leverages Kotlins Property references for safely get the name/type information and stores the definition of a model. This model is then supplied to a Mapper to auto-map the model to Values for inserts/updates, and for mapping Records back to the instance. There are 2 ways set up the schema, either explicitly construction or with annotations.</p>

<h3 id="construct">Construct</h3>

<p>Explicitly setup of a Model/Schema
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">     
    <span class="k">import</span> <span class="nn">slatekit.meta.Schema</span>

    <span class="c1">// OPTION 1: Explicit Schema Setup
</span><span class="c1"></span>    <span class="c1">// Uses property references for strongly typed setup
</span><span class="c1"></span>    <span class="c1">// Also, can use KType to get if field is required ( via isMarkedNullabel )
</span><span class="c1"></span>    <span class="k">object</span> <span class="nc">UserSchema</span> <span class="p">:</span> <span class="n">Schema</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">User</span><span class="p">&gt;(</span><span class="n">Long</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="n">User</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="s">&#34;user&#34;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">val</span> <span class="py">id</span>         <span class="p">=</span> <span class="n">id</span>    <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">id</span>        <span class="p">)</span>
        <span class="k">val</span> <span class="py">email</span>      <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">email</span>     <span class="p">,</span> <span class="n">min</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">max</span> <span class="p">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">indexed</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">first</span>      <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">first</span>     <span class="p">,</span> <span class="n">min</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">max</span> <span class="p">=</span> <span class="m">50</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">last</span>       <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">last</span>      <span class="p">,</span> <span class="n">min</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">max</span> <span class="p">=</span> <span class="m">50</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">age</span>        <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">age</span>       <span class="p">)</span>
        <span class="k">val</span> <span class="py">salary</span>     <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">salary</span>    <span class="p">)</span>
        <span class="k">val</span> <span class="py">active</span>     <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">active</span>    <span class="p">)</span>
        <span class="k">val</span> <span class="py">registered</span> <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">registered</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">createdAt</span>  <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">updatedAt</span> <span class="p">,</span> <span class="n">category</span> <span class="p">=</span> <span class="n">FieldCategory</span><span class="p">.</span><span class="n">Meta</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">updatedAt</span>  <span class="p">=</span> <span class="n">field</span>  <span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">updatedAt</span> <span class="p">,</span> <span class="n">category</span> <span class="p">=</span> <span class="n">FieldCategory</span><span class="p">.</span><span class="n">Meta</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Access the model which stores all the fields
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">model</span> <span class="p">=</span> <span class="n">UserSchema</span><span class="p">.</span><span class="n">model</span>

    <span class="c1">// Iterate over the models
</span><span class="c1"></span>    <span class="n">model</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="s">&#34;field: name=${it.name}, ${it.storedName}, ${it.isRequired}, ${it.dataTpe}&#34;</span><span class="p">)</span>
    <span class="p">}</span></code></pre></div></p>

<h3 id="annotations">Annotations</h3>

<p>You can also use annotations at the source of the data model.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">     
    <span class="k">data</span> <span class="k">class</span> <span class="nc">User</span><span class="p">(</span>
        <span class="n">@property</span><span class="p">:</span><span class="n">Id</span><span class="p">()</span>
        <span class="k">override</span> <span class="k">val</span> <span class="py">id</span><span class="p">:</span><span class="n">Long</span> <span class="p">=</span> <span class="m">0L</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">(</span><span class="n">length</span> <span class="p">=</span> <span class="m">30</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">email</span><span class="p">:</span><span class="n">String</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">(</span><span class="n">length</span> <span class="p">=</span> <span class="m">30</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">first</span><span class="p">:</span><span class="n">String</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">(</span><span class="n">length</span> <span class="p">=</span> <span class="m">30</span><span class="p">)</span>
        <span class="k">val</span> <span class="py">last</span><span class="p">:</span><span class="n">String</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">isMale</span><span class="p">:</span><span class="n">Boolean</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">age</span><span class="p">:</span><span class="n">Int</span> <span class="p">=</span> <span class="m">35</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">active</span><span class="p">:</span><span class="n">Boolean</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">salary</span><span class="p">:</span><span class="n">Double</span> <span class="p">=</span> <span class="m">100.00</span><span class="p">,</span>

        <span class="n">@property</span><span class="p">:</span><span class="n">Field</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">registered</span><span class="p">:</span><span class="n">DateTime</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="p">)</span> <span class="p">:</span> <span class="n">EntityWithId</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">&gt;</span> <span class="p">{</span>

        <span class="k">override</span> <span class="k">fun</span> <span class="nf">isPersisted</span><span class="p">():</span> <span class="n">Boolean</span> <span class="p">=</span> <span class="n">id</span> <span class="p">&gt;</span> <span class="m">0</span>
    <span class="p">}</span>

    <span class="c1">// Access the model which stores all the fields
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">model</span> <span class="p">=</span> <span class="n">ModelMapper</span><span class="p">.</span><span class="n">loadSchema</span><span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>

    <span class="c1">// Iterate over the models
</span><span class="c1"></span>    <span class="n">model</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="s">&#34;field: name=${it.name}, ${it.storedName}, ${it.isRequired}, ${it.dataTpe}&#34;</span><span class="p">)</span>
    <span class="p">}</span></code></pre></div></p>




<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/>

<h2 id="orm">ORM</h2>

<p>By having the models defined with a schema, we can then set up the auto-mapping of models. This builds the Entity Service using all the individual parts shown from prior examples.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// Setup: This is boiler-plate that can be moved
</span><span class="c1"></span>    <span class="c1">// to a helper function/builder
</span><span class="c1"></span>    <span class="c1">// 1. connection
</span><span class="c1"></span>    <span class="c1">// 2. database
</span><span class="c1"></span>    <span class="c1">// 3. mapper
</span><span class="c1"></span>    <span class="c1">// 4. repo
</span><span class="c1"></span>    <span class="c1">// 5. service
</span><span class="c1"></span>    <span class="k">val</span> <span class="py">con</span> <span class="p">=</span> <span class="n">DbConString</span><span class="p">(</span><span class="n">Vendor</span><span class="p">.</span><span class="n">H2</span><span class="p">.</span><span class="n">driver</span><span class="p">,</span> <span class="s">&#34;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">db</span> <span class="p">=</span> <span class="n">Db</span><span class="p">.</span><span class="k">open</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">model</span> <span class="p">=</span> <span class="n">UserSchema</span><span class="p">.</span><span class="n">model</span>
    <span class="k">val</span> <span class="py">mapper</span><span class="p">:</span><span class="n">Mapper</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">OrmMapper</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">model</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">Long</span><span class="o">::</span><span class="k">class</span><span class="p">,</span> <span class="n">City</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">repo</span> <span class="p">=</span> <span class="n">Repo</span><span class="p">.</span><span class="n">h2</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">db</span><span class="p">,</span> <span class="n">mapper</span><span class="p">)</span>
    <span class="k">val</span> <span class="py">service</span> <span class="p">=</span> <span class="n">EntityService</span><span class="p">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">City</span><span class="p">&gt;(</span><span class="n">repo</span><span class="p">)</span>

    <span class="n">service</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">City</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&#34;New York&#34;</span><span class="p">,</span> <span class="s">&#34;NYC&#34;</span><span class="p">))</span>

    <span class="c1">// CRUD operations
</span><span class="c1"></span>    <span class="n">service</span><span class="p">.</span><span class="n">any</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">service</span><span class="p">.</span><span class="n">getById</span><span class="p">(</span><span class="m">1</span><span class="p">)</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="events">Events</h2>

<p>Functionality available, docs coming soon.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// COMING SOON</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<h2 id="migrations">Migrations</h2>

<p>Functionality available, docs coming soon.
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin">    <span class="c1">// COMING SOON</span></code></pre></div>



<a href="arch/data#features" class="sk-back-to-details">Back to features</a>
<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>

<br/><br/><br/></p>

<br/>

<a href="arch/data#overview" class="sk-back-to-top">Back to top </a>
<br/><br/><br/><br/>

<script>
    var archComponent = {
        name: "Data",
        page: "arch/data",
        icon: "assets/media/img/white/layers.png",
        menu: {
            mode: "normal",
            useTemplate:true,
            sections: [
                {
                    name: "Guide",
                    items: [
                        { name:"Connections" , anchor: "#connections" },
                        { name:"Databases" , anchor: "#databases"  },
                        { name:"Records", anchor: "#records" },
                        { name:"Mappers" , anchor: "#mappers"  },
                        { name:"Repos" , anchor: "#repos"  },
                        { name:"Services" , anchor: "#services"  },
                        { name:"Vendors" , anchor: "#vendors"  },
                        { name:"Schemas" , anchor: "#schemas"  },
                        { name:"ORM" , anchor: "#orm"  },
                        { name:"Events" , anchor: "#events"  },
                        { name:"Migrations" , anchor: "#migrations"  }
                    ]
                }
            ]
        }
    };

    function setupArchComponent() {
        buildArchComponent(archComponent);
    }
</script>

            </div>
            <div class="col-sm-1 flex">
            </div>
        </div>
      </div>
    

    
    <section class="links">
        <div class="container text-center">
    <a href="https://twitter.com/slatekit">Twitter</a>
    <a href="https://github.com/slatekit/slatekit">Github</a>
    <a href="/info/contact">About</a>
    <a href="/info/contact">Contact</a>
</div>
    </section>
    

    
    <footer class="footer">
        <div class="container text-center">
    <p>Slate Kit developed by <a href="https://www.codehelix.co">Code Helix</a></p>
</div>
    </footer>
    

    
            
    <script src="assets/theme/js/plugins/jquery-3.4.1.min.js"></script>
    <script src="assets/theme/js/plugins/popper.min.js"></script>
    <script src="assets/theme/js/plugins/bootstrap.min.js"></script>
    <script src="assets/theme/js/plugins/jquery.waypoints.min.js"></script>
    <script src="assets/theme/js/plugins/jquery.counterup.min.js"></script>
    <script src="assets/theme/js/plugins/slick.js"></script>
    <script src="assets/theme/js/plugins/owl.carousel.min.js"></script>
    <script src="assets/theme/js/plugins/wow.min.js"></script>
    <script src="assets/theme/js/agency-1.js"></script>
    <script src="assets/app/slatekit.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-84704317-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script src="assets/theme/js/sass-1.js"></script>
    <script type="text/javascript">
        $( document ).ready(function() {
            setupArchComponent();
        });
    </script>
</body>

</html>